<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>无标题文档</title>
<script src="../static/js/jquery_1.8.js"></script>
    <script src="../static/js/jquery_cookie.js"></script>
	<link rel="shortcut icon" href="../static/images/favicon.ico?v=20160901" type="image/x-icon">
    <link href="../../static/css/shopping_cart_new.css" rel="stylesheet" type="text/css">
	<link href="../../static/css/footer_150526.css" rel="stylesheet" type="text/css" />
</head>

<body style="padding-bottom:82px">

<link href="../../static/css/header_960_150611.css" rel="stylesheet" type="text/css">
<script src="../../static/js/pagetop2015_0827.js" charset="gb2312" type="text/javascript"></script>

<div id="hd">
<div id="tools">
<div class="tools">
    <div class="ddnewhead_operate" dd_name="顶链接">
        
        <div class="ddnewhead_welcome" display="none;">
            <span id="nickname"><span class="hi">Hi，<a href="http://myhome.dangdang.com/" class="login_link" target="_blank"><b>{{ cookie }}</b></a><a href="{% url 'siteapp:tui_deng' %}" target="_self">[退出]</a></span></span>
            <div class="tel_pop" style="display:none" id="__ddnav_sjdd" onmouseover="showgaoji('a_phonechannel','__ddnav_sjdd');" onmouseout="hideotherchannel('a_phonechannel','__ddnav_sjdd');">
                <a target="_blank" href="http://t.dangdang.com/20130220_ydmr" class="title"><i class="icon_tel"></i>手机当当</a><i class="title_shadow"></i>
                <ul class="tel_pop_box">
                    <li><a href="http://t.dangdang.com/20130220_ydmr" dd_name="手机二维码"><span>当当手机客户端</span><img src="http://img3.ddimg.cn/00363/doc/erweima2.png"><span class="text">随手查订单<br>随时享优惠</span></a></li>
                </ul>
            </div>
        </div>
        <div class="new_head_znx" id="znx_content" style="display:none;"></div>
    </div>
</div>
</div>
<div id="header_end"></div>
<!--CreateDate  2016-09-28 11:30:01--></div>
<form action="http://search.dangdang.com/search.aspx" id="bootpagetopSearch" name="bootpagetopSearch" method="GET"></form>
<script type="text/javascript">var nick_num = 0;initHeaderOperate();</script><script type="text/javascript" src="http://orderb.dangdang.com/queryunpaid?callback=Unpaid_Data"></script>
		<div class="shoppingcart_wrapper" id="ad_cpt_11850"><div><a href="http://a.dangdang.com/tjump.php?q=ddo84XQOf357bOs8tXGg5%2F%2F0oVoDImt3DFWsMqu7ZMSVsfUMeOQJueASNiMLjq%2FdrXMLCKnVfyKEahteAh1ih%2ByKYrKGzhvL20LVbDzObRambBA0YPpivy5hR5foQ4Rt%2BTB" target="_blank" rel="nofollow"><img src="http://img62.ddimg.cn/2017/1/11/2017011111344969879.jpg"></a></div></div>
<div class="logo_line">
    <div class="w960">
        <div class="shopping_procedure01 shopping_procedure "><span>我的购物车</span><span class="current">填写订单</span><span>完成订单</span></div>
        <div class="logo"><a href="#"><img src="../../static/images/bz_logo_car.jpg" alt=""></a></div>
    </div>
</div>
<div class="indent_con">
	<div class="shdz">
    	<h3>收货相关信息</h3>
                 <span>选择收货地址</span>
               <select onchange="fu()" id="xiala">
                        <option value="0">选择地址</option>
                    {% for foo in di %}
                        <option value="{{ foo.id }}">{{ foo.consignee }}</option>
                    {% endfor %}

                </select>
        <ul class="shdz_con">
            <p>▪ 收货地址</p>
        	<li><label><strong>*</strong>收&nbsp;&nbsp;货&nbsp;&nbsp;人：</label><input type="text"  name="ship_man" id="shouhuoren" onblur="fn()"><span id="spn_ship_man" class="hint new_tip" style="display: block;">请填写收货人姓名</span><input type="text" id="yonghumingce" style="display: none" value="0"></li>
            <li><label><strong>*</strong>详细地址：</label><input type="text" name="ship_man"  onblur="fnn()" id="dizi"> <input id="dizhiqinding" style="display: none" type="text" value="0"></li>
            <li><label><strong>*</strong>邮政编码：</label><input type="text"  name="ship_man"  onblur="fnnn()" id="youbian"> <input id="youbian2" style="display: none" type="text" value="0"> </li>
            <li><label><strong>*</strong>手&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;机：</label><input id="dianhuaa"  type="text" name="ship_man"  onblur="fnnnn()"><label>或&nbsp;&nbsp;固定电话</label><input id="dianhuaaa" type="text" name="ship_man"  onblur="fnnnnn()"><input id="dianhua" type="text" style="display: none" value="0"></li>
             
        </ul>
        <div class="balance"><p>商品金额：¥{{ jia }}</p><p class="yfze">应付总额（含运费）：<em>¥{{ jia }}</em></p><p><a href="#" onclick="fi()">提交订单</a></p></div>
    </div>
    <div class="shdz">
    	<h3>订单1（百知网配送）</h3>
        <table width="100%" border="0" cellpadding="0" cellspacing="0">
            <tbody><tr style="height:30px; line-height:30px;">
                <th width="34%">商品名称</th>
                <th width="11%">所在仓库</th>
                <th width="13%">百知价</th>
                <th width="11%">促销价</th>
                <th width="9%">数量</th>
                <th width="11%">小计</th>
                <th width="11%">操作</th>
            </tr>
                    {% for foo in objict %}
                            <tr >
                                <td>{{ foo.isbn_id }}</td>
                                <td align="center">当当出版</td>
                                <td align="center">¥{{ foo.get }}（{% widthratio foo.get foo.id_id 10 %}折）</td>
                                <td align="center">--</td>
                                <td align="center">{{ foo.quantity }}</td>
                                <td align="center">¥ {% widthratio foo.quantity 1 foo.get %}</td>
                                <td align="center"><a href="#" style="display: none">放回购物车</a></td>
                            </tr>
                    {% endfor %}
                     <tr>
                        <td colspan="2"><input type="checkbox" >此订单作为礼品赠送他人</td>
                        <td colspan="2"><strong>运费：</strong>当确认送货方式后显示</td>
                        <td class="table_zj" colspan="3"><strong>小计总额：</strong><em>¥{{ p }}</em><input id="jine" type="text" value="{{ p }}" style="display: none"></td>
                    </tr>
                
            
                
            
        </tbody></table>
    </div>
     
</div>

<div id="footer">
<div class="footer">
	<div class="footer_nav_box">
		<div class="footer_copyright"><span>Copyright (C) 当当网 2004-2014, All Rights Reserved</span><a href="http://www.hd315.gov.cn/beian/view.asp?bianhao=010202001051000098" target="_blank" class="footer_img" rel="nofollow"><img src="http://img4.dangdang.com/bottom/validate.gif"></a><span><a href="http://www.miibeian.gov.cn/" target="_blank" rel="nofollow">京ICP证041189号</a></span><span>出版物经营许可证&nbsp;新出发京批字第直0673号</span></div>
	</div>
</div>
</div>
    <div class="foot_tip_ad">广告</div>
    <style>
        .foot_tip_ad { width:40px; height:40px; font:12px/40px "simsun"; text-align:center; color:#fff; background-color:#474747; position:fixed; right:0; bottom:10px;_position:absolute; _bottom:auto;_top:expression(eval(document.documentElement.scrollTop+document.documentElement.clientHeight-this.offsetHeight-(parseInt(this.currentStyle.marginTop,10)||0)-(parseInt(this.currentStyle.marginBottom,10)||0)));}
    </style>


<script >
{# 判断用户名会是否合法   #}
    function fn() {
        var shouhuoren = document.getElementById('shouhuoren');
        var sh = shouhuoren.value;

        var s = /^[\u4e00-\u9fa5]{2,4}$/g;
        var shou = s.test(sh);
        if (shou){
            var k = document.getElementById('yonghumingce');
            k.value = 1;

        } else {
            var l = document.getElementById('yonghumingce');
            l.value = 0;

        }
    }
{# 判断地址是否合法   #}
    function fnn() {
        var s = document.getElementById('dizi');
        var k = /^[\u4e00-\u9fa5]{6,20}$/g;
        var m = k.test(s.value);
        if (m){
            var p = document.getElementById('dizhiqinding');
            p.value = 1;

        }else {
            var j = document.getElementById('dizhiqinding');
            j.value = 0;

        }

    }
{# 判断邮箱是否合法  #}
    function fnnn() {
        var s = document.getElementById('youbian');
        var b = /^\d{6}$/g;
        var c = b.test(s.value);
        if (c){
            var a = document.getElementById('youbian2');
            a.value = 1;

        } else {
            var d = document.getElementById('youbian2');
            d.value = 0;

        }
    }

{# 判断电话是否合法#}
    function fnnnn() {
        var s = document.getElementById('dianhuaa');
        var m = /^(1[3584]\d{9,10})$/g;
        var l = m.test(s.value);
        if (l){
            var k = document.getElementById('dianhua');
            k.value = 1;

        } else {
            var j = document.getElementById('dianhua');
            j.value = 0;

        }

    }
    {# 判断用固定电话是否合法   #}
    function fnnnnn() {
        var s = document.getElementById('dianhuaaa');
        var m = /^(860\d{2,4})\d{8}$/g;
        var l = m.test(s.value);

        if (l){
            var k = document.getElementById('dianhua');
            k.value = 1;

        } else {
            var j = document.getElementById('dianhua');
            j.value = 0;

        }
    }
{# 下拉列表 #}
    function fu() {
        var s = document.getElementById('xiala');
        var k = s.value;
         var xhr;
         if (window.XMLHttpRequest){

            xhr =new XMLHttpRequest()
        }
        else if (window.ActiveXObject){
            xhr =new ActiveXObject("Microsoft.XMLHTTP")
        }
        var url = "{% url 'siteapp:ajax' %}";
        xhr.open("POST",url,true);
        xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");
        xhr.setRequestHeader('X-CSRFToken','{{ csrf_token }}');
        xhr.send("name="+k);
         xhr.onreadystatechange = function () {
                     if (xhr.readyState === 4 && xhr.status === 200) {
                         var ex = xhr.responseText;
                         var va = JSON.parse(ex);

                         {# 将后端传来的地址信息方入框中#}
                         {#用户名 #}
                         if (ex.length >3){
                         document.getElementById('shouhuoren').value = va[0].consignee;
                         var shouhuoren= document.getElementById('shouhuoren');
                         shouhuoren.readOnly= "readonly";

                         document.getElementById('yonghumingce').value = 1;

                         {#地址 #}
                         document.getElementById('dizi').value = va[0].fetailed;
                         var dizi= document.getElementById('dizi');
                         dizi.readOnly= "readonly";

                         document.getElementById('dizhiqinding').value = 1;


                         {#邮编#}
                         document.getElementById('youbian').value = va[0].postal;
                         var youbian = document.getElementById('youbian');
                         youbian. readOnly= 'readonly';

                         document.getElementById('youbian2').value = 1;

                         {#判断是电话号还是固定电话#}
                         var m = /^(1[3584]\d{9,10})$/g;
                         var s = m.test(va[0].cell_phon);

                         if (s) {
                             document.getElementById('dianhuaa').value = va[0].cell_phon;
                             var dianhuaa = document.getElementById('dianhuaa');
                             dianhuaa. readOnly = "readonly";

                             document.getElementById('dianhua').value = 1
                         } else {
                             document.getElementById('dianhuaaa').value = va[0].cell_phon;
                             var dianhuaaa = document.getElementById('dianhuaaa');
                             dianhuaaa.readOnly = "readonly";

                             document.getElementById('dianhua').value = 1
                         }

                         }else {
                          document.getElementById('shouhuoren').value = '';
                         var shouhuore= document.getElementById('shouhuoren');
                         shouhuore.readOnly= "";

                         document.getElementById('yonghumingce').value = 0;

                         {#地址 #}
                         document.getElementById('dizi').value = '';
                         var diz= document.getElementById('dizi');
                         diz.readOnly= "";

                         document.getElementById('dizhiqinding').value = 0;


                         {#邮编#}
                         document.getElementById('youbian').value ='';
                         var youbia = document.getElementById('youbian');
                         youbia. readOnly= '';

                         document.getElementById('youbian2').value = 0;

                         {#判断是电话号还是固定电话#}

                             document.getElementById('dianhuaa').value = '';
                             var dianhuaaas = document.getElementById('dianhuaa');
                             dianhuaaas. readOnly = "";

                             document.getElementById('dianhuaaa').value = '';
                             var dianhuaaaa = document.getElementById('dianhuaaa');
                             dianhuaaaa.readOnly = "";

                             document.getElementById('dianhua').value = 0



                         }






                     }

                };


    };


    function fi() {
        var yong = document.getElementById('yonghumingce');
        var di = document.getElementById('dizhiqinding');
        var you = document.getElementById('youbian2');
        var dian = document.getElementById('dianhua');
        if (yong.value === '1' && di.value === '1' && you.value === '1' && dian.value === '1'){
            var yinghu = document.getElementById('shouhuoren').value;
            var dizhi = document.getElementById('dizi').value;
            var youxiang = document.getElementById('youbian').value;
            var dianhua = document.getElementById('dianhuaa').value;
            var dianhua2 = document.getElementById('dianhuaaa').value;
            var jine = document.getElementById('jine').value;
            if (dianhua){
                location.href='{% url 'siteapp:jie_zhang' %}?yinghu='+yinghu+'&dizhi='+dizhi+'&youxiang='+youxiang+'&dianhua='+dianhua+'&jine='+jine
            } else {
                location.href='{% url 'siteapp:jie_zhang' %}?yinghu='+yinghu+'&dizhi='+dizhi+'&youxiang='+youxiang+'&dianhua='+dianhua2+'&jine='+jine
            }


        }else {
            alert('信息填写有误')
        }


    }


</script>

</body>
</html>
